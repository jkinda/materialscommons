<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Materials Commons</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="../../assets/css/bootstrap.css" rel="stylesheet">
    <link href="../../assets/css/jquery.jOrgChart.css" rel="stylesheet">
    <link href="../../assets/css/style.css" rel="stylesheet">
    <link href="../../assets/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="shortcut icon" href="../../assets/ico/mc-gear-favicon.ico">
</head>

<body>

<div class="mc-tools-sidebar">
    <ul class="mc-tools-sidenav">
        <li><a href="notebook.html"><img src="../../assets/ico/glyphish/96-book.png"> LabNotebook<i
                class="icon-chevron-right"></i></a></li>
        <li><a href="../data/data.html"><img src="../../assets/ico/glyphish/16-line-chart.png"> Find Data<i
                class="icon-chevron-right"></i></a></li>
        <li><a href="../models/models.html"><img src="../../assets/ico/glyphish/19-gear.png"> Find Models<i
                class="icon-chevron-right"></i></a></li>
    </ul>
</div>

<div id="stop-toolbar" class="navbar navbar-wrapper navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            <a class="brand" href="../../index.html">Materials Commons</a>

            <div class="nav-collapse collapse">
                <p class="navbar-text pull-right">
                    <a href="#" class="navbar-link">Login</a>
                </p>

                <ul class="nav">
                    <li><a href="#about">About</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>

            </div>
            <!--/.nav-collapse -->
        </div>
    </div>
</div>

<ul id="experiment" style="display:none">
    <li style="color: #c3eafb; width:80%"><a href="#">ALLISON-DEFORMATON-001</a>
        <ul>
            <li><a href="#">Magnesium</a>
                <ul>
                    <li>
                        <p>
                            Microstructure
                        </p>

                        <p>
                            <button id="microstructure-button" class="btn btn-primary btn-mini"
                                    onclick="microstructClicked()">Add Equipment
                            </button>
                        </p>
                        <ul id="microstructure">

                        </ul>

                    </li>
                    <li><a href="#">Mechanical</a>
                        <ul id="mechanical">
                        </ul>
                    </li>
                </ul>
            </li>
            <li><a href="#">Simulation</a></li>
        </ul>
    </li>
</ul>


<div class="container-fluid">

    <div class="row">

        <div class="span7 offset4">
            <div class="row">
                <h3>Create New Experiment</h3>

                <div class="accordion" id="a1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <a class="accordion-toggle" data-toggle="collapse" data-parent="a1" href="#c1">Experiment
                                Wizard</a>
                        </div>
                        <div id="c1" class="accordion-body collapse in">
                            <div class="accordion-inner">

                                <div id="rootwizard">
                                    <div class="navbar">
                                        <div class="navbar-inner">
                                            <div class="container">
                                                <ul>
                                                    <li><a href="#tab1" data-toggle="tab">Overview</a></li>
                                                    <li><a href="#tab2" data-toggle="tab">Material</a></li>
                                                    <li><a href="#tab3" data-toggle="tab">Experiment Type</a></li>
                                                    <li><a href="#tab4" data-toggle="tab">Validation</a></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="tab-content">
                                        <div class="tab-pane" id="tab1">
                                            <p>
                                                <input type="text" name="lab" id="lab" placeholder='Enter your lab'>
                                            </p>

                                            <p>
                                                <textarea rows="3" id="description"
                                                          placeholder="Enter description of experiment"></textarea>
                                            </p>

                                        </div>
                                        <div class="tab-pane" id="tab2">
                                            <form class="form-horizontal">
                                                <select id="metal">
                                                    <option>Magnesium 1</option>
                                                    <option>Magnesium 2</option>
                                                    <option>Magnesium 3</option>
                                                    <option>Magnesium 4</option>
                                                </select>

                                                <input type="number" step="any" placeholder="thickness" id="thickness">
                                            </form>
                                        </div>
                                        <div class="tab-pane" id="tab3">
                                            <form class="form-horizontal">
                                                <select style="width:250px;" id="etype">
                                                    <option>Microstructure Characterization</option>
                                                    <option>Mechanical Properties</option>
                                                </select>
                                            </form>
                                        </div>
                                        <div class="tab-pane" id="tab4">
                                            <label>Stuff</label>
                                        </div>
                                        <ul class="pager wizard">
                                            <li class="previous first" style="display:none;"><a href="#">First</a></li>
                                            <li class="previous"><a href="#">Previous</a></li>
                                            <li class="next last" style="display:none;"><a href="#">Last</a></li>
                                            <li class="next"><a href="#">Next</a></li>
                                            <li class="next finish" style="display: none"><a href="#">Finish</a></li>
                                        </ul>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div id="experimentBuild" class="orgChart"></div>
            </div>

            <div class="row" style="padding-top: 30px;">
                <button class="btn btn-success" onclick="saveExperiment()" id="save-button">Save</button>
            </div>
        </div>

    </div>

    <div class="row">

        <footer>
            <p>&copy; Company 2012</p>
        </footer>
    </div>

</div>
<!-- /container -->

<!-- Le javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="../../assets/js/jquery.js"></script>
<script src="http://localhost:5984/_utils/script/json2.js"></script>
<script src="http://localhost:5984/_utils/script/sha1.js"></script>
<script src="http://localhost:5984/_utils/script/jquery.couch.js"></script>
<script src="../../assets/js/jquery.jOrgChart.js"></script>
<script src="../../assets/js/jquery.bootstrap.wizard.js"></script>
<script src="../../assets/js/bootstrap.js"></script>
<script>

    //$.couch.urlPrefix = "http://localhost:5984";

    function microstructClicked(e) {
        $('#microstructure').append('<li><a href="#">New Equipment</a></li>');
        $('#experimentBuild').empty();
        $('#experiment').jOrgChart({
            chartElement:'#experimentBuild'
        });
    }

    function saveExperiment() {
        var name = $('#lab').val() + '-' + $('#metal').val() + '-TEST' + Math.floor((Math.random() * 10000) + 1);
        var description = $('#description').val();
        var doc = {
            "type":"experiment",
            "name":name,
            "description":description
        };

        $.couch.db("materialscommons").saveDoc(doc, {
            success:function (data) {
                alert("Saved new experiment");
            },

            error:function (status) {
                alert("Failed to save experiment: " + status);
            }
        });
    }

    function showValuesForValidation() {
        var lab = $('#lab').val();
        var description = $('#description').val();
        var metal = $('#metal').val();
        var thickness = $('#thickness').val();
        var etype = $('#etype').val();

        $('#tab4').empty();
        $('#tab4').append('<label>Lab:' + lab + '</label>');
        $('#tab4').append('<label>Description:' + description + '</label>');
        $('#tab4').append('<label>Metal:' + metal + '</label>');
        $('#tab4').append('<label>thickness:' + thickness + '</label>');
        $('#tab4').append('<label>Type:' + etype + '</label>');
    }

    jQuery(document).ready(function () {
        $('#rootwizard').bootstrapWizard({
            onTabShow:function (tab, navigation, index) {
                var total = navigation.find('li').length;
                var current = index + 1;
                if (index == 3) {
                    showValuesForValidation();
                }
                var percent = (current / total) * 100;
                if (current >= total) {
                    $('#rootwizard').find('.pager .next').hide();
                    $('#rootwizard').find('.pager .finish').show();
                    $('#rootwizard').find('.pager .finish').removeClass('disabled');
                } else {
                    $('#rootwizard').find('.pager .next').show();
                    $('#rootwizard').find('.pager .finish').hide();
                }
            }
        });

        $('#rootwizard .finish').click(function () {
            $('#c1').collapse('hide');
            $("#experiment").jOrgChart({
                chartElement:'#experimentBuild'
            });
        });
//        $("#experiment").jOrgChart({
//            chartElement:'#experimentBuild'
//        });
    });
</script>
</body>
</html>

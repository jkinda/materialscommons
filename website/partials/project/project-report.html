<div class="row-fluid">
    <div class="span12 offset1">
        <div class="span4">
            <h4><u>Selected Project: {{project_obj[0].name}}</u></h4>
        </div>

        <div class="span6 offset2">
            <span ng-show="selected_proj">
                      <select ng-model="add_to"
                              ui-select2="{placeholder: 'Add', allowClear: true, width:'element'}"
                              ng-multiple="false">
                          <option></option>
                          <option value="prov">Provenance</option>
                          <!--<option value="to_dataset">To Dataset</option>-->
                          <!--<option value="to_project">To Project</option>-->

                      </select>
            </span>

        </div>
    </div>
</div>

<div ng-show="add_to=='prov'">
<div class="row-fluid">
    <div class="span10 offset1">
        <div ng-show="isCurrentStep('nav_choose_process') && !display">
            <div class="well">
                <button type="button" class="close" ng-click="remove_instructions();">&times;</button>
                <b><u>Instructions - Process</u></b><br>
                <li><b>Process Type:</b> These are defined types of processes. Pre-populated in materials commons.</li>
                <li>Process Type will decide what Inputs and Outputs are required for creating provenance</li>
                <li><b>Machine:</b>Machine can be an experimental machine or either a computation</li>
                <li><b>Runs:</b> Is to keep track of exactly for how many days the process was run.</li>
            </div>
        </div>
        <div ng-show="isCurrentStep('nav_choose_inputs') && !display">
            <div class="well">
                <button type="button" class="close" ng-click="remove_instructions();">&times;</button>
                <b><u>Instructions - Inputs</u></b><br>
                <li><b>Input Files:</b> Select these input files from the project tree. These act as an input to the
                    process
                </li>
                <li><b>Required Input properties:</b> Pick any of the existing or create new. These act as input to
                    the
                    process
                </li>
            </div>
        </div>

        <div ng-show="isCurrentStep('nav_choose_outputs')  && !display">
            <div class="well">
                <button type="button" class="close" ng-click="remove_instructions();">&times;</button>
                <b><u>Instructions - Outputs</u></b><br>
                <li><b>Output Files:</b> Are the files generated by this process. You can pick them from project
                    tree
                </li>
                <li><b>Required Output properties:</b></li>
            </div>
        </div>
    </div>
</div>
<div class="row-fluid">
<div class="span12 offset1">
<div class="span2">
    <div class="well">
        <ul class="nav nav-list">
            <li class="nav-header"><i class="icon-wrench"></i>Steps</li>
            <li ng-class="{'active':isCurrentStep('nav_choose_process')}">
                <a> <i ng-show="process_saved"
                       ng-class="{true: 'icon-autoscroll', false: 'icon-autoscroll-disabled'}[process_saved]"></i>
                    Process</a> <a ng-show="process_saved" ng-controller="ProcessStepController"
                                   ng-click="edit_process()">(edit)</a>
            </li>
            <li ng-class="{'active' : isCurrentStep('nav_choose_inputs')}"><a
                    > <i ng-show="inputs_saved"
                         ng-class="{true: 'icon-autoscroll', false: 'icon-autoscroll-disabled'}[inputs_saved]"></i>
                Inputs </a><a ng-show="inputs_saved" ng-controller="InputStepController"
                              ng-click="edit_input()">(edit)</a>
            </li>
            <li ng-class="{'active' : isCurrentStep('nav_choose_outputs')}"><a
                    > <i ng-show="outputs_saved"
                         ng-class="{true: 'icon-autoscroll', false: 'icon-autoscroll-disabled'}[outputs_saved]"></i>
                Outputs </a> <a ng-show="outputs_saved" ng-controller="OutputStepController" ng-click="edit_output()">(edit)</a>
            </li>
            <li ng-class="{'active' : isCurrentStep('nav_choose_upload')}"><a
                    >Submit </a>
            </li>
        </ul>
    </div>
</div>
<div class="span10">
<div class="block" ng-show="isCurrentStep('nav_choose_process')"
     ng-controller="ProcessStepController" ng-init="init()">
<form id="process-tab" class="form-inline span8">
<span ng-show="project_warning">
              <b style="color: orange">Project was not selected</b>
        </span>

    <div class="well">
        <h4>Process Information</h4>
        <label>process type :</label> <select ng-model="process_type">
        <option disabled>Select Process Type:</option>
        <option ng-repeat="p in process_templates" value="{{p}}">
            {{p.template_name}}
        </option>
    </select>


        <div ng-show="process_type">
            <hr/>
            <label style="color:red">Name: [required]</label> <input ng-model="process.name"
                                                                     placeholder="Name your process"
                                                                     type="text"><br>
            <label>Description:</label>
            <textarea class="input-large" placeholder="Describe your process...."
                      ng-model="process.description"/> <br>
            <label>Version:</label> <input ng-model="process.version" placeholder="Version V1.1 ...."
                                           type="text"><br>


            <div class="well">
                <b>Selected Machine:<a href="#modalMachine" data-toggle="modal">{{process.machine.name}}</a></b>

                <p style="float: right" ng-show="machine_added">
                    <button class="btn btn-success">Saved</button>
                </p>
                <br> <br>
                <!-- Modal -->
                <div id="modalMachine" class="modal hide fade" tabindex="-1" role="dialog"
                     aria-labelledby="modalMachineLabel" aria-hidden="true">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
                        <h3 id="modalMachineLabel">{{process.machine.name}}</h3>
                    </div>
                    <div class="modal-body">
                        <div>
                            <label>Name:</label><span>{{process.machine.name}}</span> <br>
                            <label>Type:</label><span>{{process.machine.contact_email}}</span><br>
                            <label>birthtime:</label><span>{{process.machine.birthtime | toDateString}}</span><br>
                            <label>Description:</label><span>{{process.machine.longname}}</span><br>
                            <label>notes:</label><span>{{process.machine.notes}}</span><br>

                            <label>Model:</label>

                            <div ng-repeat="kv in process.machine.model">
                                <label>{{kv.name}}</label> - <span>{{kv.value}}</span>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
                    </div>
                </div>


                <input type="radio" ng-model="myradio" value="select">Use Existing Machine<br>
                <input type="radio" ng-model="myradio" value="create">Create New Machine

                <div ng-show="myradio=='select'">
                    select existing machine:
                    <select ng-model="machine_selected">
                        <option disabled>pick a machine:</option>
                        <option ng-repeat="m in machines_list" value="{{m}}"
                                ng-click="machine_select()">{{m.name}}
                        </option>
                        <option disabled></option>
                        <option ng-click="clear_machine()" value="clear">clear</option>
                    </select><br>
                </div>
                <div ng-show="myradio=='create'">
                    <div class="well">
                        <label>Name:</label> <span><input ng-model="process.machine.name"
                                                          placeholder="Name your machine"
                                                          type="text"></span> <br>
                        <label>Contact: </label><span><input ng-model="process.machine.contact_email"
                                                             placeholder="email.."
                                                             type="text"></span><br>
                        <label>Long Name: </label><span><input ng-model="process.machine.longname" placeholder=""
                                                               type="text"></span> <br>

                        <label>Notes:</label><span><input ng-model="process.machine.notes"
                                                          placeholder="Type your notes.."
                                                          type="text"></span> <br>
                        <label>---------Additional/Custom-----------</label><br>

                                        <span ng-repeat="pv in process.machine.model">
                                            <label>{{pv.name}}</label><span><input type="text"
                                                                                   ng-model="pv.value"></span><br>
                                        </span>
                        <label>Additional Properties:</label>
                            <span>
                                <select ng-model="p_name">
                                    <option ng-repeat="each in machine_template.model" value="{{each.name}}">
                                        {{each.name}}
                                    </option>
                                </select><button ng-click="add_property_to_machine()">add</button>
                            </span>

                        <label>Add Custom Properties:</label>
                               <span>
                                    <input ng-model="additional_prop" placeholder="type property name ....."
                                           type="text">
                                    <button ng-click="custom_property()">add</button>
                               </span>

                        <br><br>
                        <button ng-disabled="!process.machine.name" ng-click="add_machine_to_db()">Save Machine
                        </button>
                        <button ng-click="clear_machine()">clear</button>

                    </div>

                </div>

            </div>

            <div class="well">
                <label> Runs:</label> <br>
                <label>Start: </label>
                <datepicker ng-model='start_run'></datepicker>
                <br>
                <label> stop: </label>
                <datepicker ng-model='stop_run'></datepicker>
                <br>
                <label>Error Msg:</label><textarea class="input-large"
                                                   placeholder="type in error messages ....."
                                                   ng-model="new_err_msg"/><br>
                <button ng-click="add_run()" ng-disabled="!start_run">Add Run</button>

                <a style="cursor:pointer" ng-click="customruns=!customruns">view runs</a>
                <br>

                <div ng-show="customruns">
                    <table class="treetable">
                        <thead>
                        <th>Start</th>
                        <th>End</th>
                        <th>Error Message</th>
                        <th></th>
                        </thead>
                        <tbody>
                        <tr ng-repeat="run in process.runs">
                            <td>{{run.started | date:'medium'}}</td>
                            <td>{{run.stopped | date:'medium'}}</td>
                            <td>{{run.error_messages}}</td>
                            <td>
                                <button type="button" class="close" ng-click="remove_run($index);">&times;</button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>

            </div>

            <br>
            <label>Notes:</label><br><textarea class="input-xlarge" placeholder="enter notes here ....."
                                               ng-model="new_note"/><br>
            <button ng-click="add_notes()" ng-disabled="!new_note">Add Notes</button>

            <a style="cursor:pointer" ng-click="customnote=!customnote">previous notes</a> <br>
                                        <span ng-show="customnote">
                                            <br><b>Notes</b>
                                             <li ng-repeat="note in process.notes">
                                                 {{note}}
                                             </li>

                                        </span>
            <br>
            <label>Citations:</label><br><textarea class="input-xlarge"
                                                   placeholder="Provide citations here..." ng-model="new_citation"/><br>
            <button ng-click="add_citations()" ng-disabled="!new_citation">Add Citations</button>
            <a style="cursor:pointer" ng-click="customcitations=!customcitations">previous citations</a>
            <br>
                                        <span ng-show="customcitations">
                                            <br><b>Citations</b>
                                             <li ng-repeat="cit in process.citations">
                                                 {{cit}}
                                             </li>

                                        </span>
            <br>

            <div>
                <button ng-click="save_process()" ng-disabled="!process.name"> Save Process
                </button>
            </div>


        </div>

    </div>
</form>
</div>
<div class="block" ng-show="isCurrentStep('nav_choose_inputs')">
<form id="input-tab" class="form-inline span8">
<div class="well" ng-controller="ProcessStepController">
<h4>Inputs</h4>

<div ng-repeat="condition in state.attributes.process.required_conditions">
    <div class="well" ng-controller="InputStepController" ng-init="init(condition)">

        <a style="cursor:pointer" ng-click="showDetails=!showDetails">{{condition_name}}</a>

        <p style="float: right" ng-show="state.attributes.input_conditions[condition_name]">
            <button class="btn btn-success">Saved</button>
        </p>
        <br>

        <div ng-show="showDetails">
            <div ng-show="condition.template_pick">
                <div class="well">
                    <b>From what material this sample was drawn?:<a
                            href="#modalMaterial" data-toggle="modal">{{condition.material.name}}</a></b>

                    <p style="float: right" ng-show="material_added">
                        <button class="btn btn-success">Saved</button>
                    </p>
                    <br> <br>
                    <!-- Modal -->
                    <div id="modalMaterial" class="modal hide fade" tabindex="-1"
                         role="dialog"
                         aria-labelledby="modalMaterialLabel" aria-hidden="true">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal"
                                    aria-hidden="true">Ã—
                            </button>
                            <h3 id="modalMaterialLabel">
                                {{condition.material.name}}</h3>
                        </div>
                        <div class="modal-body">
                            <div>
                                <label>Name:</label><span>{{condition.material.name}}</span>
                                <br>
                                <label>Alloy:</label><span>{{condition.material.alloy_name}}</span>
                                <br>

                                <label>composition:</label>
                                <span>{{condition.material.composition}}</span> <br>
                                <label>Contact:</label>
                                <span>{{condition.material.contact_email}}</span> <br>
                                <label>Notes:</label>
                                <span>{{condition.materialnotes}}</span> <br>
                                <!--<label>Model:</label>-->

                                <!--<div ng-repeat="kv in process.material.model">-->
                                <!--<label>{{kv.name}}</label> --->
                                <!--<span>{{kv.value}}</span>-->
                                <!--</div>-->
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn" data-dismiss="modal"
                                    aria-hidden="true">Close
                            </button>
                        </div>
                    </div>

                    <input type="radio" ng-model="myradio" value="select">Use Existing
                    Material<br>
                    <input type="radio" ng-model="myradio" value="create">Create New
                    Material

                    <div ng-show="myradio=='select'">
                        select existing material:
                        <select ng-model="material_selected">
                            <option disabled>pick a material:</option>
                            <option ng-repeat="m in materials" value="{{m}}"
                                    ng-click="material_select()">{{m.name}}
                            </option>
                            <option></option>
                            <option ng-click="clear_material()" value="clear">clear
                            </option>
                        </select><br>
                    </div>
                    <div ng-show="myradio=='create'">
                        <div class="well">
                            <label>Name:</label><span><input
                                ng-model="condition.material.name"
                                placeholder="Name your material"
                                type="text"></span> <br>
                            <label>Composition</label><span><input
                                ng-model="condition.material.composition"
                                placeholder="material composition.."
                                type="text"></span><br>
                            <label>Contact:</label><span><input
                                ng-model="condition.material.contact_email"
                                placeholder="email.."
                                type="text"></span><br>

                            <label>Notes:</label><span><input
                                ng-model="condition.material.notes"
                                placeholder="Type your notes.."
                                type="text"></span> <br>
                            <br>
                            <button ng-disabled="!condition.material.name"
                                    ng-click="add_material_to_db()">Save Material
                            </button>
                            <button ng-click="clear_material()">clear</button>

                        </div>

                    </div>

                </div>
            </div>
            <label>Pick existing sample: </label>
            <select ng-model="use_condition">
                <option ng-repeat="ec in existing_conditions" value="{{ec}}"
                        ng-click="selected_condition(ec)"> {{ec.name}}
                <option disabled> -------------------</option>
                <option ng-click="clear_condition()" value="clear">Clear</option>

                </option>
            </select> <br>

            <b style="color: lightseagreen"> OR you can create one by filling out
                the form below</b><br>
            <br> <br>
            <label style="color: red">Name: [required]</label><input
                placeholder="Give a name to your property" ng-model="condition.name"
                type="text"> <br>
            <label>Description</label> <input ng-model="condition.description"
                                              type="text">
            <br>

            {{condition.template_description}}<br> <br>

            <div ng-repeat="property in condition.model">

                <label>{{property.name}}</label>

                <span ng-if="property.value_choice.length!=0">
                    <select ng-model="property.value">

                        <option ng-repeat="val in property.value_choice"> {{val}}
                        </option>
                    </select>
                </span>
                <span ng-if="property.value_choice.length==0">
                    <input ng-model="property.value" type="text">
                </span>
                <span ng-if="property.unit_choice.length!=0">
                    <label>Units:</label>
                    <select style="width:80px" ng-model="property.unit">
                        <option ng-repeat="unit in property.unit_choice"> {{unit}}
                        </option>
                    </select>
                </span>
            </div>

            <br>

            <div class="well">
                Add Custom Properties(sample):
                <input ng-model="additional_prop" type="text">
                <button ng-click="custom_property()">Add Property</button>
            </div>
            <button ng-click="save_condition()" ng-disabled="!condition.name">Save
            </button>
            <br>
        </div>

    </div>
</div>
<div ng-show="state.attributes.process.required_input_files=='yes'">
    <div class="well" ng-controller="InputStepController">
        <a style="cursor:pointer" ng-click="showDetails=!showDetails">Input files</a><br>
                                <span ng-show="showDetails">
                                        <b>Select the files from project tree shown below</b><br>
                                        <button ng-click="add_input_files()">Add Files</button>
                                </span>

        <li ng-repeat="item in state.attributes.checked_input_filenames">
            <i class="fa fa-check-square"></i>{{item.name}}
            <button type="button" class="close" ng-click="removeFile($index);">&times;</button>
            <br>
        </li>
    </div>
</div>


<div ng-controller="InputStepController">
    <div ng-show="warning"><br>
        <b style="color:orange">WARNING: Required properties should atleast have a name.</b>
    </div>
    <div ng-hide="verified">
        <button ng-click="verify_inputs()">Verify Inputs</button>

    </div>
    <div ng-show="verified">
        <b>required inputs have been verified!</b>
        <button class="btn btn-small btn-primary" ng-click="next_step()">Move to Next Step</button>
    </div>
</div>

</div>
</form>

</div>
<div class="block" ng-show="isCurrentStep('nav_choose_outputs')">
    <form id="output-tab" class="form-inline span8">
        <div class="well" ng-controller="ProcessStepController">
            <h4>Outputs</h4>

            <div ng-repeat="cond in state.attributes.process.required_output_conditions">
                <div class="well" ng-controller="OutputStepController" ng-init="init(cond)">
                    <a style="cursor:pointer" ng-click="showDetails=!showDetails">{{condition_name}}</a>

                    <p style="float: right" ng-show="state.attributes.output_conditions[condition_name]">
                        <button class="btn btn-success">Saved</button>
                    </p>
                    <br>
                                        <span ng-show="showDetails">
                                               <label>Pick one </label>
                                            <select ng-model="use_condition">
                                                <option ng-repeat="ec in existing_conditions" value="{{ec}}"
                                                        ng-click="selected_condition(ec)"> {{ec.name}}
                                                <option disabled> -------------------</option>

                                                <option ng-click="clear_condition()" value="clear">Clear</option>

                                                </option>
                                            </select> <br>
                                            <b style="color: lightseagreen"> OR you can create your own by filling out
                                                the form below</b><br>
                                            <br> <br>
                                            <label style="color: red">Name: [required]</label><input
                                                ng-model="condition.name" type="text"> <br>
                                            <label>Description</label> <input ng-model="condition.description"
                                                                              type="text">
                                            <br>
                                            {{condition.template_description}}<br><br>
                                         <div ng-repeat="property in condition.model">

                                             <label>{{property.name}}</label>
                                            <span ng-if="property.value_choice.length!=0">
                                                <select ng-model="property.value">

                                                    <option ng-repeat="val in property.value_choice"> {{val}}
                                                    </option>
                                                </select>
                                            </span>
                                            <span ng-if="property.value_choice.length==0">
                                                <input ng-model="property.value" type="text">
                                            </span>

                                            <span ng-if="property.unit_choice.length!=0">
                                                   <label>Units:</label>
                                            <select style="width:80px" ng-model="property.unit">
                                                <option ng-repeat="unit in property.unit_choice"> {{unit}}
                                                </option>
                                            </select>
                                            </span>
                                         </div>
                                            <br>
                                            <div ng-show="condition.template_pick">
                                                <div class="well">
                                                    <b>From what material this sample was drawn?:<a
                                                            href="#modalMaterial_op" data-toggle="modal">{{condition.material.name}}</a></b>

                                                    <p style="float: right" ng-show="material_added">
                                                        <button class="btn btn-success">Saved</button>
                                                    </p>
                                                    <br> <br>
                                                    <!-- Modal -->
                                                    <div id="modalMaterial_op" class="modal hide fade" tabindex="-1"
                                                         role="dialog"
                                                         aria-labelledby="modalMaterial_opLabel" aria-hidden="true">
                                                        <div class="modal-header">
                                                            <button type="button" class="close" data-dismiss="modal"
                                                                    aria-hidden="true">Ã—
                                                            </button>
                                                            <h3 id="modalMaterial_opLabel">
                                                                {{condition.material.name}}</h3>
                                                        </div>
                                                        <div class="modal-body">
                                                            <div>
                                                                <label>Name:</label><span>{{condition.material.name}}</span>
                                                                <br>
                                                                <label>Alloy:</label><span>{{condition.material.alloy_name}}</span>
                                                                <br>

                                                                <label>composition:</label>
                                                                <span>{{condition.material.composition}}</span> <br>
                                                                <label>Contact:</label>
                                                                <span>{{condition.material.contact_email}}</span> <br>
                                                                <label>Notes:</label>
                                                                <span>{{condition.material.notes}}</span> <br>

                                                            </div>
                                                        </div>
                                                        <div class="modal-footer">
                                                            <button class="btn" data-dismiss="modal"
                                                                    aria-hidden="true">Close
                                                            </button>
                                                        </div>
                                                    </div>

                                                    <input type="radio" ng-model="myradio" value="select">Use Existing
                                                    Material<br>
                                                    <input type="radio" ng-model="myradio" value="create">Create New
                                                    Material

                                                    <div ng-show="myradio=='select'">
                                                        select existing material:
                                                        <select ng-model="material_selected">
                                                            <option disabled>pick a material:</option>
                                                            <option ng-repeat="m in materials" value="{{m}}"
                                                                    ng-click="material_select()">{{m.name}}
                                                            </option>
                                                            <option></option>
                                                            <option ng-click="clear_material()" value="clear">clear
                                                            </option>
                                                        </select><br>
                                                    </div>
                                                    <div ng-show="myradio=='create'">
                                                        <div class="well">
                                                            <label>Name:</label> <span><input
                                                                ng-model="condition.material.name"
                                                                placeholder="Name your material"
                                                                type="text"></span> <br>
                                                            <label>Alloy:</label><span><input
                                                                ng-model="condition.material.alloy_name"
                                                                placeholder="alloy....."
                                                                type="text"></span><br>
                                                            <label>Composition</label><span><input
                                                                ng-model="condition.material.composition"
                                                                placeholder="material composition.."
                                                                type="text"></span><br>
                                                            <label>Contact: </label><span><input
                                                                ng-model="condition.material.contact_email"
                                                                placeholder="email.."
                                                                type="text"></span><br>

                                                            <label>Notes:</label><span><input
                                                                ng-model="condition.material.notes"
                                                                placeholder="Type your notes.."
                                                                type="text"></span> <br>
                                                            <br>
                                                            <button ng-disabled="!condition.material.name"
                                                                    ng-click="add_material_to_db()">Save Material
                                                            </button>
                                                            <button ng-click="clear_material()">clear</button>

                                                        </div>

                                                    </div>

                                                </div>
                                            </div>

                                            <br>
                                            <div class="well">
                                                Add Custom Properties(sample):
                                                <input ng-model="additional_prop" type="text">
                                                <button ng-click="custom_property()">Add Property</button>
                                            </div>
                                            <br>
                                               <button ng-click="save_condition()" ng-disabled="!condition.name">Save
                                               </button>

                                        </span>

                </div>
            </div>
            <div ng-show="state.attributes.process.required_output_files=='yes'">
                <div class="well" ng-controller="OutputStepController">
                    <a style="cursor:pointer" ng-click="showDetails=!showDetails">Output files</a><br>
                                <span ng-show="showDetails">
                                        <b>Select the files from project tree shown below</b><br>
                                        <button ng-click="add_output_files()">Add Files</button>
                                </span>

                    <li ng-repeat="item in state.attributes.checked_output_filenames">
                        <i class="fa fa-check-square"></i>{{item.name}}
                        <button type="button" class="close" ng-click="removeFile($index);">&times;</button>
                        <br>
                    </li>
                </div>
            </div>

            <div ng-controller="OutputStepController">
                <div ng-show="warning"><br>
                    <b style="color:orange">WARNING: Required properties should atleast have a name.</b>
                </div>
                <div ng-hide="verified">
                    <button ng-click="verify_outputs()">Verify Outputs</button>

                </div>
                <div ng-show="verified">
                    <b>required outputs have been verified!</b>
                    <button class="btn btn-small btn-primary" ng-click="next_step()">Move to Next Step</button>
                </div>
            </div>
        </div>

    </form>
</div>
<div class="block" ng-show="isCurrentStep('nav_choose_upload')">
    <form id="submit-tab" class="form-inline span8">


        <div ng-hide="done" class="well" ng-controller="UploadStepController">

            <div ng-show="notdone" class="well">
                <h4>Provenance failed</h4><br>
                <b>Because of following reasons:</b><br>
                <a> 1. Project was not selected</a><br>
                <a> 2. Bad input or output files</a> <br>
            </div>
            <h4>Verify and Submit</h4>


            <b>Process:</b>

            <div class="well">
                Name:<span>{{state.attributes.process.name}}</span> <br>
                Description:<span>{{state.attributes.process.description}}</span> <br>
                Machine:<span>{{state.attributes.machine_obj.name}}</span> <br>
                Version:<span>{{state.attributes.process.version}}</span> <br>

                Notes:
                <ul ng-repeat="n in state.attributes.process.notes">
                    <li>{{n}}</li>
                </ul>
                <br>
                Runs:
                <ul ng-repeat="r in state.attributes.process.runs">
                    <li>{{r.started | date:'medium'}} -
                        {{r.stopped | date:'medium'}} <br> Error Messages:
                        {{r.error_messages}}
                    </li>
                </ul>
                <br>
            </div>

            <b>Inputs:</b>

            <div class="well">
                Input Properties:<br>
                    <span ng-repeat="ip in state.attributes.input_conditions">
                        <a href="#modalCondition" data-toggle="modal"
                           ng-click="get_mode_condition(ip)">{{ip.name}}</a><br>
                    </span><br>
                Input Files:<br>
                    <span ng-repeat="file in state.attributes.checked_input_filenames">
                        <a href="#modalFile" data-toggle="modal" ng-click="get_file(file)">{{file.name}}</a><br>
                    </span><br>
            </div>

            <b>Outputs:</b>

            <div class="well">
                Output Properties:<br>
                    <span ng-repeat="ip in state.attributes.output_conditions">
                        <a href="#modalCondition" data-toggle="modal"
                           ng-click="get_mode_condition(ip)">{{ip.name}}</a><br>
                    </span><br>
                Output Files:<br>
                    <span ng-repeat="file in state.attributes.checked_output_filenames">

                        <a href="#modalFile" data-toggle="modal" ng-click="get_file(file)">{{file.name}}</a> <br>
                    </span><br>
                <!-- Modal -->
                <div id="modalFile" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="modalFileLabel"
                     aria-hidden="true">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
                        <h3 id="modalFileLabel">File: {{jet.name}}</h3>
                    </div>
                    <div class="modal-body">
                        <div>
                            <label>Name:</label><span>{{datafile.name}}</span><br>
                            <label>Type:</label><span>{{datafile.item_type}}</span> <br>
                            <label>Owner:</label><span>{{datafile.owner}}</span> <br>
                            <label>Description:</label><span>{{datafile.description}}</span> <br>
                            <label>notes:</label><span>{{datafile.notes}}</span><br>
                            <label>Tags:</label><span>{{datafile.tags}}</span><br>
                            <label>Access:</label><span>{{datafile.access}}</span><br>
                            <label>Media Type:</label><span>{{datafile.mediatype}}</span><br>

                            <div ng-switch on="fileType">
                                <div ng-switch-when="image">
                                    <img ng-src="{{ fileSrc }}">
                                    <a ng-href="{{ originalFileSrc }}" download="{{ fileName }}"
                                       style="margin-left: 15px">Download</a>
                                </div>
                                <a ng-switch-when="other" ng-href="{{ fileSrc }}">{{ doc.name }}</a>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
                    </div>
                </div>

                <!-- Modal -->
                <div id="modalCondition" class="modal hide fade" tabindex="-1" role="dialog"
                     aria-labelledby="modalConditionLabel" aria-hidden="true">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
                        <h3 id="modalConditionLabel">{{jet.name}}</h3>
                    </div>
                    <div class="modal-body">
                        <div>
                            <label>Name:</label><span>{{jet.name}}</span> <br>
                            <label>Type:</label><span>{{jet.template_type}}</span><br>
                            <label>Description:</label><span>{{jet.description}}</span><br>
                            <span ng-if="jet.material">
                                  <label>Material:</label><span>{{jet.material.name}}</span><br>
                            </span>

                            <label>Model:</label>

                            <div ng-repeat="kv in model">
                                <label>{{kv.name}}</label> - <span>{{kv.value}}</span>
                                 <span ng-if="kv.unit!=''">
                                {{kv.unit}}
                            </span>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
                    </div>
                </div>
            </div>
            <button class="btn btn-large btn-primary" type="button" ng-click="upload_state()">Submit</button>
            &nbsp;&nbsp;&nbsp
            <button class="btn btn-large btn-danger" type="button" ng-click="cancel_provenance()">Cancel</button>

        </div>
        <div ng-show="done" class="well">
            <h4>Provenance uploaded successfully</h4>
            <a href="#/mytools/process/report/{{process_id}}" ng-click="selected_project(project_obj[0].id)">view
                uploaded provenance</a>
        </div>

    </form>

</div>
</div>
</div>


</div>
</div>

<div ng-hide="add_to=='prov'" class="row-fluid">
    <div class="span11 offset1">
        <h4>Processes</h4>
        <table treetable treedata="tree_process">
            <thead>
            <tr ng-show="selected_proj">
                <th>Name</th>
                <th>Description</th>
            </tr>
            </thead>
            <tbody>

            <tr ng-repeat="t in tree_process" data-tt-id={{t.c_id}} data-tt-parent-id={{t.parent_id}}>
                <td ng-controller="ProcessReportController">
                    <span ng-if="t.parent_id==0">
                        <b>{{t.name}}</b>
                    </span>
                    <span ng-if="t.parent_id!=0">
                        <a href="#/mytools/process/report/{{t.id}}">
                            {{t.name}}</a>
                    </span>
                </td>
                <td>{{t.description}}</td>

            </tr>
            </tbody>
        </table>

    </div>
</div>

<div ng-show="loaded===false" class="row-fluid">
    <div class="span4 offset5">
        <p><i class="fa fa-spinner fa-spin fa-4x"></i> Loading...</p>
    </div>
</div>

<div ng-show="loaded===true" class="row-fluid">
    <div class="span11 offset1">
        <button ng-click="backToFolder(trailitem)"
                ng-repeat="trailitem in trail">{{trailitem.displayname}}
        </button>
    </div>
    <div class="row-fluid">
        <div class="span11 offset1">
            <h4>Project Files:</h4>
            <table class="treetable">
                <thead>
                <tr ng-show="selected_proj">
                    <th></th>
                    <th></th>
                    <th>Project</th>
                    <th>Type</th>
                    <th>Size(kb)</th>
                    <th>Owner</th>
                    <th>Date</th>
                </tr>
                </thead>
                <tbody>

                <tr ng-repeat="entry in dir" data-tt-id={{t.c_id}} data-tt-parent-id={{t.parent_id}}>
                    <td ng-if="entry.type=='datafile'">
                        <span ng-if="isChecked(entry)==true">
                                <input type="checkbox" ng-click="check(entry)" checked/>

                        </span>
                        <span ng-if="isChecked(entry)==false">
                                <input type="checkbox" ng-click="check(entry)"/>

                        </span>
                    </td>

                    <td ng-if="entry.type=='datadir'">
                        <input type="checkbox" disabled/>
                    </td>
                    <td ng-if="entry.type=='datadir'">
                        <button ng-dblclick="openFolder(entry)"><i class="fa fa-folder fa-4x"></i>{{entry.displayname}}
                        </button>
                    </td>
                    <td ng-if="entry.type=='datafile'">
                        <p><i class="fa fa-file fa-4x"></i>{{entry.displayname}}</p>
                    </td>

                    <td><a href="#/mytools/data/edit/{{entry.id}}">{{entry.name}}</a></td>
                    <td>{{entry.type}}</td>
                    <td>{{entry.size}}</td>
                    <td>{{entry.owner}}</td>
                    <td>{{entry.birthtime | toDateString}}</td>
                </tr>
                </tbody>
            </table>

        </div>
    </div>

</div>
